# Linux的虚拟IP设置

_2020-08-01_ _11:28_

在此之前对于虚拟IP的概念一直很模糊。这次，申请了两个服务器，三个IP，其中一个虚拟IP。本来想法是让网络组那边把虚拟IP绑定在F5设备上，然后对这两台服务器做负载均衡。

结果，网络组说这个网络区域没有F5...那只能自己搞起了。

假设我们的服务器IP是172.23.15.10，虚拟IP为172.23.15.11，网卡名为ens192。网卡名可以通过ifconfig看到，通常有两个，一个以太网卡，一个本地网卡。

第一个问题，虚拟IP怎么用？网卡是可以绑定多个IP的，通过如下命令绑定到以太网卡上
```
ifconfig ens192:1 172.23.15.11 netmask 255.255.252.0 broadcast 172.23.3.254 up
route add -host 172.23.15.11 dev ens192:1
//ens192:1 为网络别名
//netmask 为子网掩码
//broadcast 为网关地址
```

> 这里我犯了一个低级错误。一开始错把虚拟ip绑定到本地网卡上。结果出现本机是可以ping通这个虚拟ip，但局域网内其他服务器ping不通该ip。

执行上述命令，其他机器就可以通过172.23.15.11来访问到172.23.15.10 这台机器了。

PS. 卸载虚拟IP命令 `ifconfig ens192:1 down`